<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Hugo Varet et Jacques van Helden" />

<meta name="date" content="2018-11-25" />

<title>Introduction à R</title>

<script src="slides_intro_R_2018_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="slides_intro_R_2018_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="slides_intro_R_2018_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="slides_intro_R_2018_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="slides_intro_R_2018_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="slides_intro_R_2018_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="slides_intro_R_2018_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="slides_intro_R_2018_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="slides_intro_R_2018_files/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #cccccc; background-color: #303030; }
code > span.kw { color: #f0dfaf; } /* Keyword */
code > span.dt { color: #dfdfbf; } /* DataType */
code > span.dv { color: #dcdccc; } /* DecVal */
code > span.bn { color: #dca3a3; } /* BaseN */
code > span.fl { color: #c0bed1; } /* Float */
code > span.ch { color: #dca3a3; } /* Char */
code > span.st { color: #cc9393; } /* String */
code > span.co { color: #7f9f7f; } /* Comment */
code > span.ot { color: #efef8f; } /* Other */
code > span.al { color: #ffcfaf; } /* Alert */
code > span.fu { color: #efef8f; } /* Function */
code > span.er { color: #c3bf9f; } /* Error */
code > span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
code > span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code > span.sc { color: #dca3a3; } /* SpecialChar */
code > span.vs { color: #cc9393; } /* VerbatimString */
code > span.ss { color: #cc9393; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #f0dfaf; } /* ControlFlow */
code > span.op { color: #f0efd0; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #7f9f7f; } /* Documentation */
code > span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code > span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code > span.in { color: #7f9f7f; font-weight: bold; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction à R</h1>
<h3 class="subtitle"><em>Probabilités et statistique pour la biologie (STAT1)</em></h3>
<h4 class="author"><em>Hugo Varet et Jacques van Helden</em></h4>
<h4 class="date"><em>2018-11-25</em></h4>

</div>


<div id="se-connecter-au-serveur-rstudio-de-roscoff" class="section level2">
<h2>Se connecter au serveur RStudio de Roscoff</h2>
<p><a href="http://r.sb-roscoff.fr/auth-sign-in" class="uri">http://r.sb-roscoff.fr/auth-sign-in</a></p>
</div>
<div id="aller-dans-son-dossier-de-travail" class="section level2">
<h2>Aller dans son dossier de travail</h2>
<p>Définir une variable qui indique le chemin du dossier de travail</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">work.dir &lt;-<span class="st"> &quot;~/intro_R&quot;</span> </code></pre></div>
<p>S’il n’existe pas encore, créer le dossier de travail. (Commande Unix équivalente: “mkdir -p ~/intro_R”)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dir.create</span>(work.dir, <span class="dt">recursive =</span> <span class="ot">TRUE</span>, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Aller dans ce dossier de travail. (Commande Unix équivalente: “cd ~/intro_R”)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setwd</span>(work.dir) </code></pre></div>
<p>Où suis-je ? (Commande Unix équivalente: “pwd”)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getwd</span>()</code></pre></div>
<p>Qu’y a-t-il par ici ? (Commande Unix équivalente: “ls”)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>()</code></pre></div>
</div>
<div id="r-vu-comme-une-calculatrice" class="section level2">
<h2>R vu comme une calculatrice</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>
<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>
<span class="dv">6</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span></code></pre></div>
</div>
<div id="notion-de-variableobjet" class="section level2">
<h2>Notion de variable/objet</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">2</span>      ## Assigner une valeur à une variable
<span class="kw">print</span>(a)    ## Afficher la valeur de la variable a</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b &lt;-<span class="st"> </span><span class="dv">3</span>      ## Assigner une valeur à une seconde variable
c &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b  ## Effectuer un calcul avec 2 variables
<span class="kw">print</span>(c)    ## Afficher le contenu de la variable c</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">7</span>      ## Changer la valeur de a
<span class="kw">print</span>(c)    ## Note: le contenu de c n&#39;est pas modifié</code></pre></div>
</div>
<div id="telecharger-un-fichier" class="section level2">
<h2>Télécharger un fichier</h2>
<p>La commande <code>download()</code> permet de télécharger un fichier à partir d’un serveur.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## download.file(url = &quot;https://goo.gl/9QVAg6&quot;, destfile = &quot;expression.txt&quot;)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## download.file(url = &quot;https://goo.gl/NQWnHg&quot;, destfile = &quot;annotation.csv&quot;)</code></pre></div>
</div>
<div id="chargement-des-donnees" class="section level2">
<h2>Chargement des données</h2>
<p>Charger le contenu du fichier “expression.txt” dans une variable nommée “exprs”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> <span class="st">&quot;expression.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</code></pre></div>
<p>Accéder à l’aide d’une fonction</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(read.table)</code></pre></div>
<p>Notation alternative</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?read.table</code></pre></div>
</div>
<div id="affichage-de-lobjet-exprs" class="section level2">
<h2>Affichage de l’objet “exprs”</h2>
<p>Imprimer toutes les valeurs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(exprs)</code></pre></div>
<pre><code>                id    WT1   WT2    KO1   KO2
1  ENSG00000034510 235960 94264 202381 91336
2  ENSG00000064201    116    71     64    56
3  ENSG00000065717    118   174    124   182
4  ENSG00000099958    450   655    301   472
5  ENSG00000104164   4736  5019   4845  4934
6  ENSG00000104783   9002  8623   7720  7142
7  ENSG00000105229   1295  2744   1113  2887
8  ENSG00000105723   3353  7449   3589  7202
9  ENSG00000116199   2044  4525   2604  4902
10 ENSG00000118939   7022  2526   6269  3068
11 ENSG00000119285  15783 17359  18591 20077
12 ENSG00000121680   3133  2775   2045  2796
13 ENSG00000125384   1380  3079    869  2419
14 ENSG00000129562  12089  7958  10708  7683
15 ENSG00000129932   1744  2247   1513  3104
16 ENSG00000134198    122    66     44    16
17 ENSG00000135452    635   427    662   291
18 ENSG00000140416     83   246    136   267
19 ENSG00000147274  16013 17642  15055 18804
20 ENSG00000148090    552  1062    615  1082
21 ENSG00000148248  62324 33973  56862 37710
22 ENSG00000157036   1225  1475   1275  1373
23 ENSG00000157869   1201  1034   1025   858
24 ENSG00000159433     31   788     30   675
25 ENSG00000161692    695  1825    746  1851
26 ENSG00000167005  26866 23111  24888 22661
27 ENSG00000168517    273   112    190    77
28 ENSG00000169570    202   181    207   209
29 ENSG00000172216   3515  1981   3204  3174
30 ENSG00000175221   1988  4788   2115  5306
31 ENSG00000183161   2238   974   2089   996
32 ENSG00000185324   1236  2163   1048  2024
33 ENSG00000188985   3415  1703   3587  2096
34 ENSG00000196867    209   189    293   192
35 ENSG00000197081  14741 36309  14941 29645
36 ENSG00000198586   1216  4545   1660  3932
37 ENSG00000214121   4044  2575   3019  2506
38 ENSG00000225630   1405  8135   1569  7866
39 ENSG00000226742    158    94    153   178
40 ENSG00000238241     90    43    122   143
41 ENSG00000248751    518   718    411   597
42 ENSG00000250202    261   163    177   191
43 ENSG00000251106     94   114     63    86
44 ENSG00000253991     77    78    134    92
45 ENSG00000254470   3025  3707   2558  4066
46 ENSG00000262814  15470 11450  11656 13821
47 ENSG00000267228   3801  2465   2787  2301
48 ENSG00000267699   1488  1086   1374   939
49 ENSG00000269293    424   162    310   120
50 ENSG00000279329     55    76     58    70</code></pre>
</div>
<div id="affichage-des-premieres-lignes-de-lobjet" class="section level2">
<h2>Affichage des premières lignes de l’objet</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(exprs)</code></pre></div>
<pre><code>               id    WT1   WT2    KO1   KO2
1 ENSG00000034510 235960 94264 202381 91336
2 ENSG00000064201    116    71     64    56
3 ENSG00000065717    118   174    124   182
4 ENSG00000099958    450   655    301   472
5 ENSG00000104164   4736  5019   4845  4934
6 ENSG00000104783   9002  8623   7720  7142</code></pre>
</div>
<div id="un-peu-plus-de-lignes" class="section level2">
<h2>Un peu plus de lignes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(exprs, <span class="dt">n =</span> <span class="dv">15</span>)</code></pre></div>
<pre><code>                id    WT1   WT2    KO1   KO2
1  ENSG00000034510 235960 94264 202381 91336
2  ENSG00000064201    116    71     64    56
3  ENSG00000065717    118   174    124   182
4  ENSG00000099958    450   655    301   472
5  ENSG00000104164   4736  5019   4845  4934
6  ENSG00000104783   9002  8623   7720  7142
7  ENSG00000105229   1295  2744   1113  2887
8  ENSG00000105723   3353  7449   3589  7202
9  ENSG00000116199   2044  4525   2604  4902
10 ENSG00000118939   7022  2526   6269  3068
11 ENSG00000119285  15783 17359  18591 20077
12 ENSG00000121680   3133  2775   2045  2796
13 ENSG00000125384   1380  3079    869  2419
14 ENSG00000129562  12089  7958  10708  7683
15 ENSG00000129932   1744  2247   1513  3104</code></pre>
</div>
<div id="caracteristiques-dun-tableau" class="section level2">
<h2>Caractéristiques d’un tableau</h2>
<p>Dimensions</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(exprs)    ## Dimensions
<span class="kw">ncol</span>(exprs)   ## Nombre de colonnes
<span class="kw">nrow</span>(exprs)   ## Nombre de lignes</code></pre></div>
<p>Noms des lignes et colonnes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(exprs)
<span class="kw">rownames</span>(exprs)</code></pre></div>
</div>
<div id="resume-rapide-des-donnees-par-colonne" class="section level2">
<h2>Résumé rapide des données par colonne</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">summary</span>(exprs)</code></pre></div>
<pre><code>               id          WT1              WT2               KO1                KO2         
 ENSG00000034510: 1   Min.   :    31   Min.   :   43.0   Min.   :    30.0   Min.   :   16.0  
 ENSG00000064201: 1   1st Qu.:   264   1st Qu.:  203.2   1st Qu.:   228.5   1st Qu.:  223.5  
 ENSG00000065717: 1   Median :  1338   Median : 1903.0   Median :  1324.5   Median : 2060.0  
 ENSG00000099958: 1   Mean   :  9358   Mean   : 6498.6   Mean   :  8356.0   Mean   : 6489.5  
 ENSG00000104164: 1   3rd Qu.:  3730   3rd Qu.: 4727.2   3rd Qu.:  3491.2   3rd Qu.: 4926.0  
 ENSG00000104783: 1   Max.   :235960   Max.   :94264.0   Max.   :202381.0   Max.   :91336.0  
 (Other)        :44                                                                          </code></pre>
</div>
<div id="selection-de-colonnes-dun-tableau" class="section level2">
<h2>Sélection de colonnes d’un tableau</h2>
<p>Valeurs stockées dans la colonne nommée “WT1”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs<span class="op">$</span>WT1</code></pre></div>
<p>Notation alternative</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs[, <span class="st">&quot;WT1&quot;</span>]  ## Sélection de la colonne WT1</code></pre></div>
<p>Sélection de plusieurs colonnes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs[, <span class="kw">c</span>(<span class="st">&quot;WT1&quot;</span>, <span class="st">&quot;WT2&quot;</span>)]</code></pre></div>
<p>Sélection de colonnes par leur indice</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs[, <span class="dv">2</span>]
exprs[, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)]</code></pre></div>
</div>
<div id="histogramme-des-valeurs-dexpression-pour-wt1" class="section level2">
<h2>Histogramme des valeurs d’expression pour WT1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(exprs<span class="op">$</span>WT1)</code></pre></div>
<p><img src="figures/07_tests_multiplesunnamed-chunk-26-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="histogramme-du-logarithme-de-ces-valeurs" class="section level2">
<h2>Histogramme du logarithme de ces valeurs</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(<span class="kw">log</span>(exprs<span class="op">$</span>WT1))</code></pre></div>
<p><img src="figures/07_tests_multiplesunnamed-chunk-27-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="nuages-de-points-expressions-ko1-vs-wt1" class="section level2">
<h2>Nuages de points – Expressions KO1 vs WT1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">log</span>(exprs<span class="op">$</span>WT1), <span class="dt">y =</span> <span class="kw">log</span>(exprs<span class="op">$</span>KO1))</code></pre></div>
<p><img src="figures/07_tests_multiplesunnamed-chunk-28-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="personnalisation-des-parametres-graphiques" class="section level2">
<h2>Personnalisation des paramètres graphiques</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">log</span>(exprs<span class="op">$</span>WT1),   ## données pour l’abscisse
     <span class="dt">y =</span> <span class="kw">log</span>(exprs<span class="op">$</span>KO1),   ## données pour l’ordonnée
     <span class="dt">main =</span> <span class="st">&quot;Expression KO1 vs WT1&quot;</span>,  ## Titre principal
     <span class="dt">xlab =</span> <span class="st">&quot;WT1&quot;</span>,  ## légende de l’axe X
     <span class="dt">ylab =</span> <span class="st">&quot;KO1&quot;</span>,  ## légende de l’axe Y
     <span class="dt">pch =</span> <span class="dv">16</span>,      ## caractère pour marquer les points
     <span class="dt">las =</span> <span class="dv">1</span>,       ## écrire les échelles horizontalement
     <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)   ## couleur des points</code></pre></div>
<p><img src="figures/07_tests_multiplesunnamed-chunk-29-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="selection-de-lignes-dun-tableau" class="section level2">
<h2>Sélection de lignes d’un tableau</h2>
<p>Sélection des lignes 4 et 11 du tableau des expressions</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs[<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">11</span>), ]</code></pre></div>
<p>Indices des lignes correspondant aux IDs ENSG00000253991 et ENSG00000099958</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(exprs<span class="op">$</span>id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ENSG00000253991&quot;</span>, <span class="st">&quot;ENSG00000099958&quot;</span>))</code></pre></div>
<p>Afficher les lignes correspondantes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs[<span class="kw">which</span>(exprs<span class="op">$</span>id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ENSG00000253991&quot;</span>, <span class="st">&quot;ENSG00000099958&quot;</span>)), ]</code></pre></div>
</div>
<div id="calculs-sur-des-colonnes" class="section level2">
<h2>Calculs sur des colonnes</h2>
<p>Calcul de moyennes par ligne (<code>rowMeans</code>) pour un sous-ensemble donné des colonnes (WT1 et WT2).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rowMeans</span>(exprs[,<span class="kw">c</span>(<span class="st">&quot;WT1&quot;</span>,<span class="st">&quot;WT2&quot;</span>)])</code></pre></div>
<p>Ajout de colonnes avec les expressions moyennes des WT et des KO.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs<span class="op">$</span>meanWT &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(exprs[,<span class="kw">c</span>(<span class="st">&quot;WT1&quot;</span>,<span class="st">&quot;WT2&quot;</span>)])
exprs<span class="op">$</span>meanKO &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(exprs[,<span class="kw">c</span>(<span class="st">&quot;KO1&quot;</span>,<span class="st">&quot;KO2&quot;</span>)])

<span class="kw">head</span>(exprs) ## Check the result</code></pre></div>
<p>Fold-change KO vs WT</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs<span class="op">$</span>FC &lt;-<span class="st"> </span>exprs<span class="op">$</span>meanKO <span class="op">/</span><span class="st"> </span>exprs<span class="op">$</span>meanWT
<span class="kw">head</span>(exprs) ## Check the result</code></pre></div>
<p>Moyenne de tous les échantillons</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs<span class="op">$</span>mean &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(exprs[,<span class="kw">c</span>(<span class="st">&quot;WT1&quot;</span>,<span class="st">&quot;WT2&quot;</span>,<span class="st">&quot;KO1&quot;</span>,<span class="st">&quot;KO2&quot;</span>)])</code></pre></div>
</div>
<div id="ma-plot-log2fc-vs-intensite" class="section level2">
<h2>MA-plot: log2FC vs intensité</h2>
<p><span class="math inline">\(M\)</span> est le logarithme en base 2 du rapport d’expression.</p>
<p><span class="math display">\[M = log_{2} (\text{FC}) = log_{2} \left( \frac{\text{KO}}{\text{WT}} \right) = log_2 (\text{KO}) - log_2(\text{WT})\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs<span class="op">$</span>M &lt;-<span class="st"> </span><span class="kw">log2</span>(exprs<span class="op">$</span>FC)</code></pre></div>
<p><span class="math inline">\(A\)</span> (average intensity) est la moyenne des logarithmes des valeurs d’expression.</p>
<p><span class="math display">\[A = \frac{1}{2} log_2 (\text{KO} \cdot \text{WT}) = \frac{1}{2} \left( log_2 (\text{KO}) + log_2(\text{WT}) \right)\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs<span class="op">$</span>A &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(<span class="kw">log2</span>(exprs[,<span class="kw">c</span>(<span class="st">&quot;meanWT&quot;</span>, <span class="st">&quot;meanKO&quot;</span>)]))</code></pre></div>
</div>
<div id="ma-plot-log2fc-vs-intensite-1" class="section level2">
<h2>MA-plot: log2FC vs intensité</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x =</span> exprs<span class="op">$</span>A, <span class="dt">y =</span> exprs<span class="op">$</span>M, <span class="dt">main =</span> <span class="st">&quot;MA plot&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>,
     <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">xlab =</span> <span class="st">&quot;A = intensity&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;M = log2FC&quot;</span>)
<span class="kw">grid</span>(<span class="dt">lty =</span> <span class="st">&quot;solid&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;lightgray&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="figures/07_tests_multiplesunnamed-chunk-39-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="charger-les-annotations-des-genes" class="section level2">
<h2>Charger les annotations des gènes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">annot &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> <span class="st">&quot;annotation.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)
<span class="kw">dim</span>(annot)   ## Vérifier les dimensions
<span class="kw">head</span>(annot)  ## Afficher quelques lignes</code></pre></div>
<p>Combien de gènes par chromosome ?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(annot<span class="op">$</span>chr)</code></pre></div>
<p>Question: combien de gènes sur le chromosome 8 ? Et sur le X ?</p>
</div>
<div id="diagramme-en-batons-genes-par-chromosomes" class="section level2">
<h2>Diagramme en bâtons – gènes par chromosomes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">sort</span>(<span class="kw">table</span>(annot<span class="op">$</span>chr)), <span class="dt">horiz =</span> <span class="ot">TRUE</span>, <span class="dt">las =</span> <span class="dv">1</span>,
        <span class="dt">main =</span> <span class="st">&quot;Genes per chromosome&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Chromosome&quot;</span>, 
        <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Number of genes&quot;</span>)</code></pre></div>
<p><img src="figures/07_tests_multiplesunnamed-chunk-42-1.png" width="40%" style="display: block; margin: auto;" /></p>
</div>
<div id="selectionner-les-donnees-du-chromosome-8" class="section level2">
<h2>Sélectionner les données du chromosome 8</h2>
<p>1ere étape: fusionner les deux tableaux exprs et annot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs.annot &lt;-<span class="st"> </span><span class="kw">merge</span>(exprs, annot, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)
<span class="kw">head</span>(exprs.annot)</code></pre></div>
<p>2eme étape: sous-ensemble des lignes pour lesquelles chr vaut 8</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs8 &lt;-<span class="st"> </span>exprs.annot[<span class="kw">which</span>(exprs.annot<span class="op">$</span>chr <span class="op">==</span><span class="st"> </span><span class="dv">8</span>),]
<span class="kw">print</span>(exprs8)</code></pre></div>
</div>
<div id="exporter-exprs8-dans-un-fichier" class="section level2">
<h2>Exporter exprs8 dans un fichier</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.table</span>(<span class="dt">x =</span> exprs8, <span class="dt">file =</span> <span class="st">&quot;exprs8.txt&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,
            <span class="dt">row.names =</span> <span class="ot">TRUE</span>, <span class="dt">col.names =</span> <span class="ot">NA</span>)</code></pre></div>
</div>
<div id="a-ajouter-aller-plus-loin-optionnel" class="section level2">
<h2>A ajouter: ALLER PLUS LOIN (optionnel)</h2>
<ul>
<li>charger un tableau complet de données (RNA-seq ou ChIP-seq et refaire quelques plots)</li>
<li>hist(breaks = 100)</li>
<li>apply</li>
<li>sort, order</li>
<li>lm() ?</li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
